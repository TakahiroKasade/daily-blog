<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <title>Daily Coding | Java Developer</title>
    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <!-- Custom CSS -->
    <link href="/css/style.css" rel="stylesheet">
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Hero Effects CSS -->
    <link href="/css/hero-effects.css" rel="stylesheet">
    <!-- Card Effects CSS -->
    <link href="/css/card-effects.css" rel="stylesheet">
    <!-- Responsive CSS -->
    <link href="/css/responsive.css" rel="stylesheet">
</head>
<body>

<!-- Navigation (Fragment) -->
<nav th:replace="~{fragments/navbar :: navbar}"></nav>


<div class="container" style="margin-top: 80px;">
    
    <!-- Hero Section -->
    <div class="hero-section text-center position-relative overflow-hidden">
        <!-- 動態背景圓形 (裝飾用) -->
        <div class="hero-bg-circle"></div>

        <div class="container position-relative z-1">
            <!-- 大頭貼 -->
            <div class="mb-4">
                <div class="avatar-container d-inline-block p-1 rounded-circle border border-2 border-primary">
                    <!-- 這裡先用 FontAwesome 當大頭貼，之後可以換成 <img> -->
                    <div class="bg-dark rounded-circle d-flex align-items-center justify-content-center" 
                         style="width: 120px; height: 120px;">
                        <i class="fas fa-user-astronaut fa-4x text-light"></i>
                    </div>
                </div>
            </div>

            <!-- 標題 -->
            <h1 class="hero-title display-4 fw-bold mb-3">
                Hello, I'm <span class="text-primary" th:text="${name} ?: 'Takahiro'"></span>
            </h1>

            <!-- 打字機特效 -->
            <h3 class="h4 text-light mb-4 text-secondary">
                I am a <span class="typewriter text-primary"></span><span class="cursor">|</span>
            </h3>

            <!-- 技能標籤 -->
            <div class="mt-4 mb-5">
                <span class="skill-tag"><i class="fab fa-java me-1"></i> Java 17</span>
                <span class="skill-tag"><i class="fas fa-leaf me-1"></i> Spring Boot</span>
                <span class="skill-tag"><i class="fas fa-database me-1"></i> PostgreSQL</span>
                <span class="skill-tag"><i class="fab fa-docker me-1"></i> Docker</span>
            </div>

            <!-- 按鈕 -->
            <div class="d-flex justify-content-center gap-3 mb-4">
                <a href="#portfolio" class="btn btn-primary btn-lg px-4 rounded-pill">
                    <i class="fas fa-folder-open me-2"></i>Portfolio
                </a>
                <a href="#blog" class="btn btn-outline-light btn-lg px-4 rounded-pill">
                    <i class="fas fa-pen-nib me-2"></i>Blog
                </a>
                <a href="/resume" class="btn btn-outline-info btn-lg px-4 rounded-pill">
                    <i class="fas fa-file-alt me-2"></i>Resume
                </a>
            </div>

            <!-- 搜尋框 (移到 Hero Section) -->
            <div class="row justify-content-center">
                <div class="col-md-6">
                    <form action="/" method="get" class="position-relative">
                        <div class="input-group input-group-lg">
                            <span class="input-group-text bg-white border-0 text-primary ps-4"><i class="fas fa-search"></i></span>
                            <input class="form-control border-0 ps-2 py-3" type="search" name="keyword" 
                                   placeholder="Search for articles..." aria-label="Search" th:value="${keyword}" style="border-radius: 0 50px 50px 0;">
                            <button class="btn btn-primary rounded-pill px-4 ms-2 position-absolute end-0 top-0 bottom-0 m-1" type="submit" style="z-index: 5;">Search</button>
                        </div>
                        <!-- input-group-text 圓角修正 -->
                        <style>
                            .input-group-text { border-radius: 50px 0 0 50px; }
                        </style>
                    </form>
                <!-- Search Result Alert -->
                <div th:if="${keyword}" class="mt-3 text-white">
                    <i class="fas fa-info-circle me-1"></i>
                    搜尋 "<strong>[[${keyword}]]</strong>" 找到 <strong>[[${posts.size()}]]</strong> 篇文章
                    <a href="/" class="text-info ms-2 text-decoration-underline"><i class="fas fa-times me-1"></i>清除</a>
                </div>

                <!-- Category Filter Alert -->
                <div th:if="${category}" class="mt-3 text-white">
                    <i class="fas fa-filter me-1"></i>
                    正在瀏覽分類： <strong class="badge bg-warning text-dark">[[${category}]]</strong>
                    <a href="/" class="text-info ms-2 text-decoration-underline"><i class="fas fa-times me-1"></i>清除</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Portfolio Section -->
    <section id="portfolio" class="mb-5">
        <div class="d-flex align-items-center mb-4">
            <h2 class="h3 fw-bold text-white mb-0"><i class="fas fa-rocket text-primary me-2"></i>精選專案</h2>
            <div class="ms-3 flex-grow-1 border-top border-secondary"></div>
        </div>
        
        <div class="row g-4">
            <div class="col-md-6" th:each="project : ${projects}">
                <div class="card h-100">
                    <!-- 專案縮圖 -->
                    <img th:src="${project.imageUrl == null || project.imageUrl == '' ? 'https://via.placeholder.com/400x200?text=No+Image' : 
                                 (#strings.startsWith(project.imageUrl, 'http') ? project.imageUrl : '/uploads/' + project.imageUrl)}" 
                         class="card-img-top" alt="Project Image" style="height: 200px; object-fit: cover;"
                         onerror="this.onerror=null;this.src='https://via.placeholder.com/400x200?text=No+Image';">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-start mb-3">
                            <h3 class="card-title h5" th:text="${project.name}">Project Name</h3>
                            <span class="badge bg-primary">Side Project</span>
                        </div>
                        <p class="card-text small mb-4" th:text="${project.description}">Description...</p>
                        <div class="d-flex justify-content-between align-items-center">
                            <div class="small text-muted">Thinking in Java</div>
                            <a th:if="${project.websiteUrl}" th:href="${project.websiteUrl}" class="btn btn-sm btn-outline-info" target="_blank">
                                View Source <i class="fas fa-external-link-alt ms-1"></i>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Blog Section -->
    <section id="blog" class="mb-5">
        <div class="d-flex align-items-center mb-4">
            <div class="d-flex align-items-center">
                <h2 class="h3 fw-bold text-white mb-0"><i class="fas fa-terminal text-primary me-2"></i>最新筆記</h2>
                <a href="/posts/new" class="btn btn-sm btn-outline-success ms-3"  sec:authorize="isAuthenticated()">
                    <i class="fas fa-plus me-1"></i> New Post
                </a>
            </div>
            <div class="ms-3 flex-grow-1 border-top border-secondary"></div>
        </div>

        <div class="row">
            <div class="col-md-12">
                <div class="list-group list-group-flush bg-transparent gap-3">
                    <div th:each="post : ${posts}" class="post-card p-4 mb-3">
                        <div class="d-flex w-100 justify-content-between mb-2">
                            <h5 class="mb-1 text-info fw-bold">
                                <!-- 分類放在前面 (可點擊) -->
                                <a th:href="@{/(category=${post.category})}" 
                                   class="badge bg-secondary me-2 text-decoration-none highlight-hover" 
                                   th:text="${post.category}">Tech</a>
                                <!-- 標題放在後面 -->
                                <span th:text="${post.title}">Post Title</span>
                            </h5>
                            <div class="text-end">
                                <small class="d-block text-muted" th:text="${#temporals.format(post.createdTime, 'yyyy-MM-dd')}">Date</small>
                                <span class="read-time justify-content-end">
                                    <i class="far fa-clock me-1"></i> <span th:text="${post.readingTime}">5 min read</span>
                                </span>
                            </div>
                        </div>
                        
                        <!-- 封面圖片 (如果有) -->
                        <div th:if="${post.coverImage}" class="mb-3">
                            <img th:src="@{'/uploads/' + ${post.coverImage}}" class="img-fluid rounded" 
                                 style="max-height: 300px; width: 100%; object-fit: cover;" alt="Cover Image">
                        </div>

                        <p class="mb-3 text-light" th:text="${summaries[post.id]}">Content Summary...</p>
                        <div class="d-flex justify-content-between align-items-center mt-2 pt-3 border-top border-secondary">
                            <a th:href="@{/posts/{id}(id=${post.id})}" class="btn btn-sm btn-outline-primary rounded-pill px-3">Read Full Story</a>
                            <div sec:authorize="hasRole('ADMIN')">
                                <a th:href="@{/posts/edit/{id}(id=${post.id})}" 
                                   class="btn btn-sm btn-outline-info me-2">
                                   <i class="fas fa-edit"></i>
                                </a>
                                <a th:href="@{/posts/delete/{id}(id=${post.id})}" 
                                   class="btn btn-sm btn-outline-danger"
                                   onclick="return confirm('你是認真的嗎？刪除後救不回來喔！');">
                                   <i class="fas fa-trash-alt"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="text-center">
        <p class="mb-0">© 2026 Daily Coding. Built with <i class="fas fa-heart text-danger"></i> & Spring Boot.</p>
        <small class="text-muted">Designed optimized for recruitment.</small>
    </footer>

</div>

<!-- Scripts -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
    // Typewriter Effect
    const words = ["Java Developer.", "Spring Boot Lover.", "Bug Hunter.", "Coffee Drinker."];
    let i = 0;
    let timer;

    function typeWriter() {
        const heading = document.querySelector(".typewriter");
        const word = words[i];
        let j = 0;
        let isDeleting = false;

        function loop() {
            heading.innerHTML = isDeleting ? word.substring(0, j--) : word.substring(0, j++);

            if (!isDeleting && j === word.length + 1) {
                isDeleting = true;
                setTimeout(loop, 2000); // Pause at end of word
            } else if (isDeleting && j === -1) {
                isDeleting = false;
                i = (i + 1) % words.length;
                setTimeout(loop, 500); // Pause before next word
            } else {
                setTimeout(loop, isDeleting ? 100 : 150); // Typing speed
            }
        }
        loop();
    }

    document.addEventListener('DOMContentLoaded', typeWriter);
</script>
</body>
</html>
