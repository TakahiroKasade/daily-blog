# 20260220_功能實作：圖片上傳、文章目錄與留言系統

本日完成了「內容體驗優化」與「互動功能」兩大階段的核心功能，大幅提升了部落格的完整度與使用者體驗。

## 1. 圖片上傳功能 (Image Upload)
### 需求分析
原先系統僅支援外部圖片網址 (URL)，對於本地檔案管理不便。

### 實作細節
- **FileStorageService**:
    - 實作檔案儲存邏輯，將上傳的 `MultipartFile` 存至專案根目錄的 `uploads/` 資料夾。
    - 使用 `UUID` 產生唯一檔名，防止檔名衝突。
- **WebMvcConfig**:
    - 設定 `ResourceHandler`，將 URL 路徑 `/uploads/**` 映射至本地檔案系統。
- **Controller & Entity**:
    - `Post` 與 `Project` 實體新增/更新圖片欄位。
    - Controller 處理檔案上傳並儲存檔名至資料庫。
- **Frontend**:
    - `create_post.html`, `edit_post.html` 等表單新增 `enctype="multipart/form-data"`。
    - 加入 `onerror` 事件處理，當圖片載入失敗時自動顯示預設圖 (Placeholder)。

## 2. 閱讀體驗優化 (Reading Experience)
### 自動生成目錄 (Table of Contents, TOC)
- **前端實作**:
    - 使用 JavaScript 自動掃描文章內容 (`.post-content`) 中的 `h1`, `h2`, `h3` 標籤。
    - 動態生成側邊導覽列，並實作點擊平滑捲動 (Smooth Scroll)。
    - 使用 Bootstrap Grid System (3:9) 進行響應式排版，手機版自動隱藏目錄。

### 相關文章推薦 (Related Posts)
- **後端邏輯**:
    - `PostRepository` 新增查詢方法，撈取「同分類」且「非當前文章」的最新 3 篇文章。
- **前端顯示**:
    - 在文章底部顯示相關文章卡片，增加讀者黏著度。

## 3. 留言評論系統 (Comment System)
### 資料庫設計
- **Entity**: `Comment`
- **關聯**: 多對一 (`@ManyToOne`) 指向 `Post`。
- **Cascade**: 設定 `CascadeType.ALL`，刪除文章時連同留言一併刪除。

### 後端實作
- **Repository**: `CommentRepository` 支援依文章 ID 查詢並按時間排序。
- **Service**: 封裝新增留言的商業邏輯。
- **Controller**: 處理 `POST` 請求，並在留言後重導回文章頁面 (帶上 `#comments` 錨點)。

### 前端實作
- **留言列表**: 顯示暱稱、時間與內容。
- **留言表單**: 開放式留言設計 (無需登入也可留言)。

---

## 4. 技術儀表板 (Tech Dashboard)
### 功能說明
展示作者最新的 GitHub 開發活動，讓訪客知道作者持續有在產出程式碼。

### 核心技術：Spring RestTemplate + GitHub Open API
這是一個經典的 **第三方 API 串接** 範例。
我們並不需要使用複雜的 GitHub SDK，而是直接透過 HTTP 請求獲取公開資料。

#### 1. API 選擇
使用 GitHub 提供的公開事件 API：
`GET https://api.github.com/users/{username}/events/public`
- **優點**：無需申請 Token (存取公開資料時)，無需 OAuth 認證。
- **限制**：**只能存取 Public Repository 的活動**。如果是 Private Repo 的 commit 這裡看不到。
- **額度**：未驗證的請求每小時限制 60 次 (開發時需注意)。

#### 2. 資料轉換 (JSON to DTO)
GitHub 回傳的 JSON 結構非常複雜，我們只需要其中的一小部分。
- 建立 `GithubEvent` DTO (Data Transfer Object)。
- 使用 `Jackson` (Spring Boot 內建) 自動將 JSON 欄位映射到 Java 物件。
- 關鍵欄位：
    - `type`: 過濾 `PushEvent` (只顯示程式碼提交)。
    - `repo.name`: 專案名稱。
    - `payload.commits`: 取得 commit message。

#### 3. 服務層邏輯 (GithubService)
- 使用 `RestTemplate` 發送 GET 請求。
- 使用 Java Stream API 進行資料過濾 (`filter`) 與 限制筆數 (`limit(5)`)。
- **例外處理**：當 API 呼叫失敗 (例如斷網或超過額度) 時，回傳空列表，確保首頁不會因為這個附屬功能壞掉而整頁崩潰 (Graceful Degradation)。

## 下一步規劃
- **部署準備**: 設定 Production 環境與資料庫。
