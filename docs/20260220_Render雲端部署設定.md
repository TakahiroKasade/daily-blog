# 20260220_Render雲端部署設定

## 1. 部署架構概覽

```
GitHub (程式碼) → Render (自動拉取 + Docker 編譯) → 網站上線
                         ↓
               Render PostgreSQL (雲端資料庫)
```

## 2. 新增檔案說明

### application-prod.properties (正式環境設定)
- **用途**: 與開發環境 (`application.properties`) 分離，避免本地密碼外洩。
- **關鍵設定**:
    - `spring.datasource.url=${DATABASE_URL}`: 使用環境變數注入資料庫連線，不寫死在程式碼裡。
    - `server.port=${PORT:8080}`: Render 會動態指定 Port，如果沒指定則預設 8080。
    - `spring.thymeleaf.cache=true`: 正式環境開啟快取提升效能。
- **啟動方式**: 透過 `spring.profiles.active=prod` 來啟用。

### Dockerfile (容器化設定)
- **用途**: 告訴 Render 如何編譯和啟動你的 App。
- **多階段建置 (Multi-Stage Build)**:
    - **Stage 1 (build)**: 使用 `maven:3.9` 映像檔編譯打包成 JAR。
    - **Stage 2 (run)**: 使用輕量的 `eclipse-temurin:17-jre` 運行 JAR。
    - **好處**: 編譯環境不會被帶進最終 Image，減少體積約 60%。

### .dockerignore
- **用途**: 類似 `.gitignore`，排除不需要進 Docker 的檔案 (`.git`, `.idea`, `target/` 等)。
- **好處**: 加快 Docker 的 Build 速度。

## 3. Spring Profiles 機制

| Profile | 設定檔 | 用途 |
|---------|--------|------|
| (預設) | `application.properties` | 本地開發 (localhost PostgreSQL) |
| prod | `application-prod.properties` | 正式環境 (Render 雲端 PostgreSQL) |

Spring Boot 會根據 `SPRING_PROFILES_ACTIVE` 環境變數來決定載入哪個設定檔。
