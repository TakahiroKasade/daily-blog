# Phase 4 + 4.5: äº’å‹•å¼å±¥æ­· + ç¶“æ­· CRUD æŠ€è¡“æ–‡ä»¶

> æ—¥æœŸï¼š2026/02/12
> é–‹ç™¼è€…ï¼šTakahiro Kasade
> ç‹€æ…‹ï¼šâœ… å®Œæˆ

---

## ğŸ“‹ å®Œæˆé …ç›®

| é …ç›® | æª”æ¡ˆ | èªªæ˜ |
|------|------|------|
| âœ… Entity | `Experience.java` | ç¶“æ­·å¯¦é«”ï¼štitle, company, description, startDate, endDate, category, skills |
| âœ… Repository | `ExperienceRepository.java` | JPA Repository + `findByCategory()` è‡ªè¨‚æŸ¥è©¢ |
| âœ… Service | `ExperienceService.java` | `getAllExperiences()` / `getByCategory()` |
| âœ… Controller | `ResumeController.java` | GET `/resume` â†’ å›å‚³ resume.html |
| âœ… View | `resume.html` | æ™‚é–“è»¸ UI (Timeline) + Navbar çµ±ä¸€ |
| âœ… CSS | `style.css` | Timeline æ¨£å¼ (å‚ç›´ç·šã€åœ“é»ã€Hover å‹•ç•«) |
| âœ… DataSeeder | `DataSeeder.java` | 3 ç­†æ¸¬è©¦è³‡æ–™ (WORK / EDUCATION / PROJECT) |
| âœ… DevTools | `pom.xml` + `application.properties` | ç†±éƒ¨ç½²è¨­å®š |
| âœ… CRUD Service | `ExperienceService.java` | `saveExperience()` / `getExperienceById()` / `deleteExperienceById()` |
| âœ… CRUD Controller | `ResumeController.java` | 5 å€‹ CRUD ç«¯é» (new/create/edit/update/delete) |
| âœ… æ–°å¢è¡¨å–® | `create_experience.html` | æ–°å¢ç¶“æ­·è¡¨å–® (category ä¸‹æ‹‰é¸å–®) |
| âœ… ç·¨è¼¯è¡¨å–® | `edit_experience.html` | ç·¨è¼¯ç¶“æ­·è¡¨å–® (è‡ªå‹•å¸¶å…¥ç¾æœ‰è³‡æ–™) |
| âœ… æ¬Šé™æ§åˆ¶ | `resume.html` | ADMIN æ‰èƒ½çœ‹åˆ°æ–°å¢/ç·¨è¼¯/åˆªé™¤æŒ‰éˆ• (sec:authorize) |
| âœ… Navbar Fragment | `fragments/navbar.html` | å…±ç”¨å°è¦½åˆ—å…ƒä»¶ï¼Œ6 å€‹é é¢çµ±ä¸€å¼•ç”¨ |

---

## ğŸ“ ç•°å‹•æª”æ¡ˆ

```
æ–°å¢ï¼š
  src/main/java/.../entity/Experience.java
  src/main/java/.../repository/ExperienceRepository.java
  src/main/java/.../service/ExperienceService.java
  src/main/java/.../controller/ResumeController.java
  src/main/resources/templates/resume.html

ä¿®æ”¹ï¼š
  src/main/java/.../config/DataSeeder.java         (æ–°å¢å±¥æ­·ç¨®å­è³‡æ–™)
  src/main/resources/static/css/style.css           (æ–°å¢ Timeline CSS)
  src/main/resources/templates/index.html            (Navbar æ•´ç† + Resume å…¥å£)
  pom.xml                                            (æ–°å¢ DevTools ä¾è³´)
  application.properties                             (Thymeleaf cache=false)
  README.md                                          (æ–°å¢ Phase 4 åŠŸèƒ½èªªæ˜)

  src/main/resources/templates/create_experience.html  (æ–°å¢ç¶“æ­·è¡¨å–®)
  src/main/resources/templates/edit_experience.html    (ç·¨è¼¯ç¶“æ­·è¡¨å–®)
  src/main/resources/templates/fragments/navbar.html   (å…±ç”¨ Navbar Fragment)

å…¨ç«™ navbar æ›¿æ›ç‚º th:replaceï¼š
  index.html / resume.html / create_post.html / edit_post.html
  create_experience.html / edit_experience.html
```

---

## ğŸ“ Q&A å­¸ç¿’ç­†è¨˜

### Q1: `JpaRepository<Experience, Long>` æ³›å‹çš„å…©å€‹åƒæ•¸åˆ†åˆ¥ä»£è¡¨ä»€éº¼ï¼Ÿ

```java
public interface ExperienceRepository extends JpaRepository<Experience, Long> {
//                                                          â†‘            â†‘
//                                                    Entity å‹åˆ¥     PK å‹åˆ¥
}
```

- **ç¬¬ä¸€å€‹** `Experience`ï¼šé€™å€‹ Repository ç®¡ç†çš„ Entity é¡åˆ¥
- **ç¬¬äºŒå€‹** `Long`ï¼šè©² Entity çš„ä¸»éµ (@Id) è³‡æ–™å‹åˆ¥
- JPA æœƒæ ¹æ“šæ³›å‹è‡ªå‹•ç”¢ç”Ÿ `findById(Long)`ã€`findAll()` ç­‰æ–¹æ³•

### Q2: å»ºç«‹ç‰©ä»¶æ™‚ï¼Œå»ºæ§‹å­ vs Setter æœ‰ä½•å·®ç•°ï¼Ÿ

```java
// å¯«æ³• Aï¼šå»ºæ§‹å­ â€” ä¸€è¡Œå»ºç«‹ï¼Œç°¡æ½”
Experience e1 = new Experience("Java å·¥ç¨‹å¸«", "æŸå…¬å¸", "æè¿°", ...);

// å¯«æ³• Bï¼šSetter â€” é€ä¸€è¨­å®šï¼Œå¯è®€æ€§é«˜
Experience e1 = new Experience();
e1.setTitle("Java å·¥ç¨‹å¸«");
e1.setCompany("æŸå…¬å¸");
```

| | å»ºæ§‹å­ | Setter |
|--|--------|--------|
| å„ªé» | ä¸€è¡Œæå®š | æ¯è¡Œçœ‹å¾—æ¸…æ¥šæ˜¯å“ªå€‹æ¬„ä½ |
| ç¼ºé» | åƒæ•¸å¤šæ™‚å®¹æ˜“ææ··é †åº | æ¯”è¼ƒå†—é•· |

### Q3: Spring Boot DevTools æ˜¯ä»€éº¼ï¼Ÿç‚ºä»€éº¼æ”¹ HTML ä¸ç”¨é‡å•Ÿï¼Ÿ

```xml
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-devtools</artifactId>
    <scope>runtime</scope>
</dependency>
```

- **DevTools** æä¾›ç†±éƒ¨ç½² (Hot Reload) åŠŸèƒ½
- æ­é… `spring.thymeleaf.cache=false` ä½¿ç”¨
- æ”¹ **HTML/CSS** â†’ é‡æ–°æ•´ç†ç€è¦½å™¨å³å¯ï¼ˆä¸ç”¨é‡å•Ÿï¼‰
- æ”¹ **Java ç¨‹å¼ç¢¼** â†’ DevTools æœƒè‡ªå‹•é‡å•Ÿï¼ˆä½†é‚„æ˜¯è¦ç­‰å¹¾ç§’ï¼‰

### Q4: Timeline UI çš„ CSS åŸç†æ˜¯ä»€éº¼ï¼Ÿ

```css
/* å‚ç›´ç·šï¼šç”¨ ::before å½å…ƒç´ ç•«ä¸€æ¢ç·š */
.timeline::before {
    content: '';
    position: absolute;
    left: 20px;
    width: 2px;
    background: linear-gradient(...);
}

/* åœ“é»ï¼šçµ•å°å®šä½åœ¨å‚ç›´ç·šä¸Š */
.timeline-dot {
    position: absolute;
    left: 12px;
    border-radius: 50%;         /* åœ“å½¢ */
    box-shadow: 0 0 12px ...;   /* éœ“è™¹ç™¼å…‰ */
}
```

- `::before` å½å…ƒç´ ç”¢ç”Ÿå‚ç›´ç·šï¼ˆä¸éœ€è¦é¡å¤– HTML æ¨™ç±¤ï¼‰
- `.timeline-dot` ç”¨ `position: absolute` å®šä½åœ¨ç·šä¸Š
- `.timeline-content` ç”¨ `padding-left` è®“å…§å®¹é¿é–‹å·¦å´ç·šæ¢

### Q5: `model.addAttribute()` çš„ key ç‚ºä»€éº¼å¾ˆé‡è¦ï¼Ÿ

```java
// Controller å‚³éçµ¦å‰ç«¯
model.addAttribute("experience", experience);  // key = "experience"

// HTML è¡¨å–®ç¶å®š
// th:object="${experience}"  â† å¿…é ˆèˆ‡ key å®Œå…¨åŒ¹é…
```

- **å¸¸è¦‹éŒ¯èª¤**ï¼šåˆ—è¡¨ç”¨ `"experiences"`ï¼ˆè¤‡æ•¸ï¼‰ï¼Œè¡¨å–®ç”¨ `"experience"`ï¼ˆå–®æ•¸ï¼‰
- å¦‚æœ key å¯«éŒ¯ï¼ŒThymeleaf æœƒæ‹‹ `BindingResult` éŒ¯èª¤

### Q6: `sec:authorize` æ€éº¼æ§åˆ¶æŒ‰éˆ•é¡¯ç¤ºï¼Ÿ

```html
<!-- åƒ… ADMIN ç™»å…¥å¾Œæ‰èƒ½çœ‹åˆ° -->
<div sec:authorize="hasRole('ADMIN')">
    <a href="/experiences/new">æ–°å¢ç¶“æ­·</a>
</div>
```

- `sec:authorize` æ˜¯ **thymeleaf-extras-springsecurity6** æä¾›çš„
- æœªç™»å…¥ / æ™®é€š USER â†’ é€™å€‹ `div` ä¸æœƒè¢«æ¸²æŸ“
- ADMIN ç™»å…¥ â†’ æ‰æœƒé¡¯ç¤ºæŒ‰éˆ•

### Q7: `th:fragment` å’Œ `th:replace` æ˜¯ä»€éº¼ï¼Ÿ

```html
<!-- å®šç¾©ç‰‡æ®µï¼ˆåœ¨ fragments/navbar.htmlï¼‰ -->
<nav th:fragment="navbar" class="navbar ...">
    ... å°è¦½åˆ—å…§å®¹ ...
</nav>

<!-- å¼•ç”¨ç‰‡æ®µï¼ˆåœ¨å…¶ä»–é é¢ï¼‰ -->
<nav th:replace="~{fragments/navbar :: navbar}"></nav>
<!-- Thymeleaf æœƒæŠŠé€™å€‹ <nav> å®Œå…¨å–ä»£ç‚º navbar.html è£¡çš„å…§å®¹ -->
```

| èªæ³• | ä½œç”¨ |
|------|------|
| `th:fragment` | å®šç¾©ä¸€å€‹å¯é‡ç”¨çš„ HTML ç‰‡æ®µ |
| `th:replace` | ç”¨ç‰‡æ®µ**å–ä»£**æ•´å€‹æ¨™ç±¤ |
| `th:insert` | æŠŠç‰‡æ®µ**æ’å…¥**åˆ°æ¨™ç±¤è£¡é¢ |

**å¥½è™•**ï¼šæ”¹ä¸€å€‹æª”æ¡ˆï¼Œå…¨ç«™ 6 å€‹é é¢çš„ navbar è‡ªå‹•æ›´æ–°ï¼

---

## â­ï¸ ä¸‹ä¸€æ­¥

- Phase 5: å…¨ç«™ UI ç¾åŒ– / Tech Dashboard / éƒ¨ç½²ä¸Šç·š
